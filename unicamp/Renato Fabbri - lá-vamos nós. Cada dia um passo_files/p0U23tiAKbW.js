/*!CK:3266932873!*//*1435554634,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["FD+g7"]); }

__d("MessengerAttachmentImageBlock.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MessengerAttachmentImageBlock",propTypes:{attachment:k.object.isRequired},render:function(){return (g.createElement("div",{className:i(this.props.className,this._computeClass())},this._renderImage(),g.createElement("div",{className:"_5swm"},this.props.children)));},_renderImage:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var n=this._getDimensions(),o=n.height,p=n.width,q=o>p,r=m(o,p),s=o&&p?o/p*100:100,t=(q||r)?.2:1,u=(q||r)?s:52,v={backgroundImage:'url('+this.props.attachment.media.image+')',minHeight:'0px',paddingBottom:q&&s>150?'136px':u*t+'%'};if(this.props.attachment.description&&this.props.attachment.source)v.minHeight='112px';return (g.createElement("div",{className:"_3xn1",style:v}));},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(),o=n.height,p=n.width,q=o>p;return (("_3xn3")+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":''));},_getDimensions:function(){var n=this.props.attachment.properties||{},o=n.height,p=n.width;if(o&&p){o=parseInt(o,10);p=parseInt(p,10);return {height:o,width:p};}return {height:0,width:0};}});function m(n,o){return n<=300&&o<=300;}e.exports=l;},null);
__d("MercuryShareImage.react",["ChatImageArrowDirection","ChatImageWithArrow.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"MercuryShareImage",propTypes:{height:l.number.isRequired,source:l.string.isRequired,width:l.number.isRequired},render:function(){return (i.createElement("div",{className:"_4hsl"},i.createElement(h,{arrowDirection:g.BOTH,height:this.props.height,source:this.props.source,width:this.props.width})));}});e.exports=m;},null);
__d("MercuryFallbackShareAttachmentContent.react",["Image.react","ImageBlock.react","LineClamp.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","URI","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=n,s=r.PropTypes,t=72,u=n.createClass({displayName:"MercuryFallbackShareAttachmentContent",propTypes:{attachment:k,location:s.oneOf(j.getValues())},statics:{modifyURIUsingLocation:function(v,w){if(w===j.MESSENGER&&!v.getDomain())v.setDomain('facebook.com').setSubdomain(o.getRequestURI().getSubdomain()).setProtocol('https');return v;}},render:function(){var v=this.props.attachment,w=this.props.location,x=((j.CHAT===w?"_49or":'')+(j.WEB_INBOX===w?' '+"__nm":'')+(j.CHAT_PREVIEW===w?' '+"_324d":'')+(j.CHAT!==w?' '+"_tih":'')+(!(v&&v.media.image)?' '+"_49ou":'')),y=(n.createElement("div",{className:"__6j"},n.createElement("div",{className:"__6k"},v.title),n.createElement("div",{className:"__6l"},v.description),n.createElement("div",{className:"__6m"},v.source)));if(v.media&&v.media.image){if(j.CHAT===w||j.CHAT_PREVIEW===w){return (n.createElement(h,{className:x,spacing:"medium"},n.createElement(l,{height:t,source:v.media.image,width:t}),n.createElement("div",{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:t}},y)));}else if(j.MESSENGER===w){var z;if(v.description)z=(n.createElement("div",{className:"__6l"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:16},v.description)));var aa;if(v.source)aa=(n.createElement("div",{className:"__6m"},v.source));return (n.createElement(m,{className:x,attachment:v},n.createElement("div",{className:"__6j"},n.createElement("div",{className:"__6k"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:18},v.title)),z,aa),this.props.children));}return (n.createElement(h,{className:q(this.props.className,x)},n.createElement(g,{className:"__6n",src:v.media.image,width:t}),y,this.props.children));}return (n.createElement("div",{className:q(this.props.className,x)},y,this.props.children));}});e.exports=u;},null);
__d("MercuryFallbackShareAttachment.react",["Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=k.createClass({displayName:"MercuryFallbackShareAttachment",propTypes:{attachment:j,location:o.oneOf(i.getValues())},renderLink:function(q){var r=this.props.location;if(i.isPreview(r))return q;var s=h.modifyURIUsingLocation(new l(this.props.attachment.uri),r);return (k.createElement(g,{className:"_5rw4",href:s,target:"_blank"},q));},render:function(){return this.renderLink(k.createElement(h,k.__spread({},this.props)));}});e.exports=p;},null);
__d("MercurySharePreview.react",["AsyncRequest","LeftRight.react","LoadingIndicator.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentRenderLocations","React","XUICloseButton.react","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=l,q=p.PropTypes,r=l.createClass({displayName:"MercurySharePreview",propTypes:{imageSize:q.shape({width:q.number.isRequired,height:q.number.isRequired}).isRequired,location:q.oneOf(k.getValues()).isRequired,share:q.shape({params:q.array,type:q.number}),uri:q.string,onClose:q.func,onUpdate:q.func},getInitialState:function(){return {attachmentData:null,loading:false};},componentWillMount:function(){this._requestID=1337;this._currentRequest=null;},componentWillUnmount:function(){this._reset();},componentWillReceiveProps:function(s){o(!(s.share&&s.uri));if(!s.share&&!s.uri)return this._reset();var t=this.state.attachmentData||this.state.loading;if(s.share&&!t){this._loadFromShare(s.share);}else if(s.uri&&!(t&&this.props.uri==s.uri))this._loadFromURI(s.uri);},componentDidUpdate:function(s,t){this.props.onUpdate&&this.props.onUpdate(this);},getShareData:function(){return this.state.attachmentData&&this.state.attachmentData.share_data;},isLoading:function(){return this.state.loading;},_loadFromShare:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromParams/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,share_params:s.params,share_type:s.type}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_loadFromURI:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromURI/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,uri:s}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_getNextRequestID:function(){return (++this._requestID);},_getCurrentRequestID:function(){return this._requestID;},_onShareLoaded:function(s,t){if(this._getCurrentRequestID()!==s)return;this.setState({loading:false,attachmentData:t.payload});},_close:function(){this._reset();this.props.onClose&&this.props.onClose();},_reset:function(){this._getNextRequestID();this._currentRequest&&this._currentRequest.abort();this._currentRequest=null;this.setState({loading:false,attachmentData:null});},render:function(){var s=(("_tig")+(' '+"_tih"));if(this.state.loading)return (l.createElement(h,{direction:h.DIRECTION.right,className:s},l.createElement(i,{className:"_tii",size:"large",color:"white"}),l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close})));var t=this.state.attachmentData;if(!t)return l.createElement("div",null);return (l.createElement("div",null,l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close}),l.createElement(j,{attachment:t,location:k.CHAT_PREVIEW})));}});e.exports=r;},null);