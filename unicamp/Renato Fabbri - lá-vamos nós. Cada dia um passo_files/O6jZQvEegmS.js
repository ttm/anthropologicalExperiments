/*!CK:1387393397!*//*1436905643,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TvJrx"]); }

__d("ChatSearchSource",["requireWeak","AbstractSearchSource","AsyncRequest","CurrentUser","MercuryParticipantTypes","SearchableEntry","SearchSourceCallbackManager","ShortProfiles","TokenizeUtil","emptyFunction","isValidUniqueID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=null;g('OrderedFriendsList',function(v){r=v;});for(var s in h)if(h.hasOwnProperty(s))u[s]=h[s];var t=h===null?null:h.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=h;function u(v){this.$ChatSearchSource0=new m({parseFn:o.parse,matchFn:o.isQueryMatch,indexFn:v.indexFn});this.$ChatSearchSource1=v.queryRequests||[];this.$ChatSearchSource2=false;}u.prototype.bootstrapImpl=function(v){n.fetchAll().then(function(){this.$ChatSearchSource2=true;this.$ChatSearchSource3();v();}.bind(this));};u.prototype.searchImpl=function(v,w,x){var y=null,z={},aa=x&&x.onQueryFinished,ba=x&&x.onQueryStarted;ba&&ba(v);var ca=this.$ChatSearchSource0.search(v,function(fa){if(!y){y=fa;y.forEach(function(ga){return z[ga.getUniqueID()]=true;});}else fa.forEach(function(ga){var ha=ga.getUniqueID();if(!z[ha]){y.push(ga);z[ha]=true;}});w(y,v);if(v.length===1&&this.$ChatSearchSource2)aa&&aa(v);}.bind(this),x);if(!ca||!this.$ChatSearchSource1||!this.$ChatSearchSource1.length||v.length===0){aa&&aa(v);return;}if(v.length===1){if(this.$ChatSearchSource2)aa&&aa(v);return;}var da={value:v,existing_ids:y&&y.map(function(fa){return fa.getUniqueID();}).join(','),needs_friends:!this.$ChatSearchSource2,limit:x&&x.threadLimit},ea=this.$ChatSearchSource1.length;this.$ChatSearchSource1.forEach(function(fa){this.$ChatSearchSource4(da,fa,function(ga){this.$ChatSearchSource5(this.$ChatSearchSource6(this.$ChatSearchSource7(ga)).filter(function(ha){return !!ha;}),v);ea--;if(ea===0){this.$ChatSearchSource0.setQueryStringAsExhausted(v);aa&&aa(v);}}.bind(this));}.bind(this),this);};u.prototype.getAllEntriesMap=function(){return this.$ChatSearchSource0.getAllEntries();};u.prototype.$ChatSearchSource3=function(){var v=n.getCachedProfileIDs(),w=v.filter(function(y){var z=n.getNow(y);return (y==j.getID()||z.type===k.FRIEND);}),x=w.map(this.$ChatSearchSource8);if(x.length)this.$ChatSearchSource0.addLocalEntries(x);};u.prototype.$ChatSearchSource6=function(v){return v.map(this.$ChatSearchSource9,this);};u.prototype.$ChatSearchSource9=function(v,w){if(v.mercury_thread){if(!r)return null;return r.normalizeThreadEntry(v,w);}var x=v.text,y=v.uid;if(!x||!q(y))return null;return new l({uniqueID:y,title:x,order:r?r.getActiveRank(y):0,subtitle:v.subtext,type:v.render_type||v.type,photo:v.photo,uri:v.path,auxiliaryData:{isMessengerUser:v.is_messenger_user,alias:v.alias}});};u.prototype.$ChatSearchSource7=function(v){var w=v.getPayload();if(Array.isArray(w)){return w;}else if(w&&w.entries){return w.entries;}else return [];};u.prototype.$ChatSearchSource8=function(v){var w=n.getNow(v),x=v==j.getID()?k.FRIEND:w.type,y=[w.additionalName,w.alternateName].concat(w.searchTokens||[]).join(' ');return new l({uniqueID:v,title:w.name,order:r?r.getActiveRank(v):0,subtitle:w.additionalName,keywordString:y,type:x,photo:w.thumbSrc,uri:w.uri,auxiliaryData:{isMessengerUser:w.is_messenger_user,alias:w.alias}});};u.prototype.$ChatSearchSource4=function(v,w,x,y){new i(w.uri).setData(Object.assign({},v,w.data)).setMethod('GET').setReadOnly(true).setHandler(x).setErrorHandler(y||p).setAllowCrossPageTransition(true).send();};u.prototype.$ChatSearchSource5=function(v,w){if(v.length)this.$ChatSearchSource0.addQueryEntries(v,w);};u.prototype.addLocalEntries=function(v){this.$ChatSearchSource0.addLocalEntries(v);};u.prototype.refreshData=function(){n.fetchAll();g('AvailableList',function(v){return v.update();});};e.exports=u;},null);
__d("MessengerTypeaheadUtils",["immutable","MercuryTypeaheadConstants","React","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k={sortEntries:function(l){var m=[],n=[],o=[],p=[],q=[];l.forEach(function(r){switch(r.getType()){case h.FRIEND_TYPE:m.push(r);break;case h.FB4C_TYPE:n.push(r);break;case h.THREAD_TYPE:o.push(r);break;case h.PAGE_TYPE:q.push(r);break;case h.NON_FRIEND_TYPE:p.push(r);break;}});return m.concat(n,o,q,p);},sortEntriesWithoutPages:function(l){var m=[],n=[],o=[],p=[];l.forEach(function(q){switch(q.getType()){case h.FRIEND_TYPE:m.push(q);break;case h.FB4C_TYPE:n.push(q);break;case h.THREAD_TYPE:o.push(q);break;case h.NON_FRIEND_TYPE:p.push(q);break;}});return m.concat(n,o,p);},sortEntriesWithoutGroupsOrViewer:function(l,m){var n=[],o=[],p=[];l.forEach(function(q){if(q.getUniqueID()===m)return;switch(q.getType()){case h.FRIEND_TYPE:n.push(q);break;case h.FB4C_TYPE:o.push(q);break;case h.NON_FRIEND_TYPE:p.push(q);break;}});return n.concat(o,p);},buildListSections:function(l){if(!l.length)return g.OrderedMap();var m=[],n=[],o=[],p=[],q=[],r=[];l.forEach(function(s){switch(s.getType()){case h.FRIEND_TYPE:n.push(s);break;case h.FB4C_TYPE:o.push(s);break;case h.THREAD_TYPE:p.push(s);break;case h.PAGE_TYPE:r.push(s);break;case h.NON_FRIEND_TYPE:q.push(s);break;}});if(n.length)m.push(['',n]);if(o.length)m.push([j._("Arbeitskollegen"),o]);if(p.length)m.push([j._("Gruppenunterhaltungen"),p]);if(r.length)m.push([j._("Unternehmen"),r]);if(q.length)m.push([j._("Weitere Personen"),q]);return g.OrderedMap(m);},scrollEntryIntoView:function(l,m){var n=i.findDOMNode(m),o=m.getScrollTop(),p=l.offsetTop-o,q=n.offsetHeight-l.offsetHeight;if(p>=q){m.scrollToPosition(o+p-q);}else if(p<0)m.scrollToPosition(o+p);}};e.exports=k;},null);
__d("ShareDialogAudienceTypeahead.react",["Grid.react","React","XUITypeahead.react","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=g.GridItem,n=h,o=n.PropTypes,p=h.createClass({displayName:"ShareDialogAudienceTypeahead",propTypes:{searchSource:o.object.isRequired,userId:o.string,prefix:o.string,onClear:o.func,onChange:o.func},getDefaultProps:function(){return {onClear:k,onChange:k};},getInitialState:function(){return {query:'',selectedEntry:null};},_onBlur:function(){if(!this.state.selectedEntry||this.state.selectedEntry.getTitle()!==this.state.query)this._clearSelection();},_clearSelection:function(){this.setState({query:'',selectedEntry:null});this.props.onClear();},render:function(){var q=this.props,r=q.className,s=(function(x,y){var z={},aa=Object.prototype.hasOwnProperty;if(x==null)throw new TypeError();for(var ba in x)if(aa.call(x,ba)&&!aa.call(y,ba))z[ba]=x[ba];return z;})(q,{className:1}),t=!!this.state.selectedEntry,u={};if(this.props.userId)u[this.props.userId]=true;var v=this.props.prefix?h.createElement("span",{className:"_2qx7"},this.props.prefix):h.createElement("noscript",null),w=this.props.prefix?"_2qx6":null;return (h.createElement(g,{className:w,cols:2},h.createElement(m,{key:"prefix",className:"_1ho1"},v),h.createElement(m,{key:"suffix",className:"_1xk6"},h.createElement(i,h.__spread({},s,{className:l(r,(("_39y9")+(t?' '+"_39ya":''))),excludedEntries:u,onChange:this._onChange,onClear:this._onClear,onBlur:this._onBlur,onSelectAttempt:this._onSelect,queryString:this.state.query,searchSource:this.props.searchSource,focusedOnInit:true,showEntriesOnFocus:false,clearable:true,selectedEntry:this.state.selectedEntry,tallInput:true})))));},_onSelect:function(q){this.setState({query:q.getTitle(),selectedEntry:q});this.props.onChange([q.getUniqueID()]);},_onChange:function(event){var q=event.target.value;if(this.state.selectedEntry&&this.state.selectedEntry.getTitle()!==q){this.setState({query:q,selectedEntry:null});}else this.setState({query:q});},_onClear:function(){this.setState({query:'',selectedEntry:null});this.props.onClear();}});e.exports=p;},null);
__d("ShareDialogGroupAudience.react",["React","ShareDialogAudienceTypeahead.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m=g.createClass({displayName:"ShareDialogGroupAudience",propTypes:{searchSource:l.object.isRequired,onClear:l.func,onSelect:l.func},getInitialState:function(){return {query:'',selectedEntry:null};},render:function(){var n=j._("Gruppe:");return (g.createElement(h,g.__spread({},this.props,{prefix:n,showPhoto:true,name:"audience_group",inputID:"audience_group",className:"_2n3i",placeholder:j._("Gruppenname")})));}});e.exports=m;},null);
__d("ShareDialogMessageAudience.react",["ChatSearchSource","Grid.react","MercuryTypeaheadConstants","MessengerTypeaheadUtils","React","XUITokenizer.react","XUITokenizerToken.react","XUITypeaheadView.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=h.GridItem,r=k,s=r.PropTypes,t=k.createClass({displayName:"ShareDialogMessageAudience",propTypes:{searchSource:s.object.isRequired,userId:s.string,onClear:s.func,onChange:s.func,messageTargets:s.array,showGroupThreads:s.bool},componentWillMount:function(){if(this.props.showGroupThreads)this._searchSource=new g({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});},getInitialState:function(){return {entries:[]};},render:function(){var u=this._shouldBeDisabled();return (k.createElement(h,{className:"_2qx6",cols:2},k.createElement(q,{className:"_1ho1",key:"prefix"},k.createElement("span",{className:"_2qx7"},p._("An:"))),k.createElement(q,{className:"_1xk6",key:"suffix"},k.createElement(l,k.__spread({},this.props,{className:(("_39y9")+(' '+"_42z0")+(u?' '+"_39ya":'')),placeholder:p._("Namen"),name:"audience_message",inputID:"audience_message",value:this.state.entries,focusedOnInit:true,selectOnTab:true,showEntriesOnFocus:false,entries:this.state.entries,searchSource:this.props.showGroupThreads?this._searchSource:this.props.searchSource,onRemoveEntryAttempt:this._onRemoveEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,disabled:u,presenter:{ViewRenderer:n,TokenRenderer:m,useLayer:true,sortEntries:this.props.showGroupThreads?this._sortEntries:null}})))));},componentDidMount:function(){var u=this.props.messageTargets;if(u)for(var v=0;v<u.length;++v)if(u[v])this._onAddEntryAttempt(u[v]);},_sortEntries:function(u){if(this.state.entries.length)return j.sortEntriesWithoutGroupsOrViewer(u,this.props.userId);return j.sortEntriesWithoutPages(u);},_shouldBeDisabled:function(){var u=this.state.entries;return u.length===1&&u[0].getType()===i.THREAD_TYPE;},_onAddEntryAttempt:function(u){var v=u.getUniqueID(),w=this.state.entries,x=w.some(function(y){if(y.getUniqueID()===v)return true;});if(x)return;w.push(u);this.props.onChange(w.map(function(y){return y.getUniqueID();}));this.setState({entries:w});},_onRemoveEntryAttempt:function(u){var v=u.getUniqueID(),w=this.state.entries,x=w.some(function(y){if(y.getUniqueID()===v)return true;});if(x)w.splice(w.indexOf(u),1);this.props.onChange(w.map(function(y){return y.getUniqueID();}));if(w.length===0)this.props.onClear();this.setState({entries:w});}});e.exports=t;},null);
__d("ShareDialogPageAudience.react",["React","Image.react","LeftRight.react","ShareActorSelector.react","XUISelector.react","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=g,q=p.PropTypes,r=k.Option,s=g.createClass({displayName:"ShareDialogPageAudience",propTypes:{pagesSource:q.object.isRequired,onClear:q.func,onSelect:q.func},getInitialState:function(){var t=o(this.props.pagesSource)[0];return {selectedPageID:t.id,selectedActorID:t.id,onClear:m,onChange:m};},render:function(){if(!this.props.pagesSource)return g.createElement("span",null);var t=o(this.props.pagesSource).map(function(u){return (g.createElement(r,{key:u.id,value:u.id,icon:g.createElement(h,{src:u.pic,height:15,width:15})},u.name));});return (g.createElement("div",{className:"_15u8"},g.createElement(i,null,g.createElement(k,{className:"_15u9",name:"audience_page",inputID:"audience_page",maxheight:150,value:this.state.selectedPageID,defaultValue:this.state.selectedPageID,onChange:function(u){this.setState({selectedPageID:u.value});this.props.onChange([{pageId:u.value,actorId:this.state.selectedActorID}]);}.bind(this)},t),g.createElement("span",null,g.createElement("strong",{className:"_15ua"},n._("Posten als"),' '),g.createElement(j,{name:"audience_page_identity",onChange:function(u){this.setState({selectedActorID:u.value});this.props.onChange([{pageId:this.state.selectedPageID,actorId:u.value}]);}.bind(this),targetID:this.state.selectedPageID})))));}});e.exports=s;},null);
__d("ShareDialogPersonAudience.react",["React","ShareDialogAudienceTypeahead.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m=g.createClass({displayName:"ShareDialogPersonAudience",propTypes:{searchSource:l.object.isRequired,userId:l.string,onClear:l.func,onSelect:l.func},render:function(){var n=j._("FreundIn:");return (g.createElement(h,g.__spread({},this.props,{prefix:n,searchSource:this.props.searchSource,className:"_4heg",name:"friendTarget",inputID:"friendTarget",clearable:true,placeholder:j._("Name des Freundes")})));}});e.exports=m;},null);