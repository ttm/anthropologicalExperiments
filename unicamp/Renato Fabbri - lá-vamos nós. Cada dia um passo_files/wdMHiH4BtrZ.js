/*!CK:2282462655!*//*1435674583,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["P96yp"]); }

__d("ChatMiniSidebarUser.react",["AvailableListConstants","ChatOpenTab","Image.react","Link.react","WebMessengerPermalinkConstants","ReactComponentWithPureRenderMixin","React","ReactLayeredComponentMixin","Tooltip","XUIAmbientNUX.react","cx","emptyFunction","ix","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=m,v=u.PropTypes,w=m.createClass({displayName:"ChatMiniSidebarUser",mixins:[l,n],propTypes:{context:v.string,detailedStatus:v.string,expanding:v.bool.isRequired,id:v.string.isRequired,isHighlighted:v.bool,isOffline:v.bool.isRequired,name:v.string.isRequired,onMouseLeave:v.func,onMouseOver:v.func,onNUXSeen:v.func,onOpenTab:v.func,onScrollIntoView:v.func,section:v.string.isRequired,shouldShowNUX:v.bool,status:v.number.isRequired,statusTime:v.string,thumbSrc:v.string.isRequired},getDefaultProps:function(){return {onMouseLeave:r,onMouseOver:r,onNUXSeen:r};},componentDidUpdate:function(x){if(this.props.isHighlighted&&!x.isHighlighted){var y=m.findDOMNode(this);this.props.onScrollIntoView&&this.props.onScrollIntoView(y);}},_openTab:function(){h.openUserTab(this.props.id,this.props.section);this.props.onOpenTab&&this.props.onOpenTab();},_onClick:function(x){this._openTab();x.preventDefault();},_renderImage:function(){return m.createElement(i,{src:this.props.thumbSrc,alt:""});},_renderName:function(){if(!this.props.expanding)return null;return (m.createElement("div",{className:"_4rqx"},this.props.name));},_renderContext:function(){return (m.createElement("div",{className:"_4rqx _1hml"},this.props.context));},_renderStatus:function(){var x=null;if(this.props.status==g.ACTIVE){x=s('/images/litestand_classic/sidebar/online.png');}else if(this.props.status==g.MOBILE)x=s('/images/litestand_classic/sidebar/pushable.png');var y=x?m.createElement(i,{className:"_d9q",src:x}):null;return (m.createElement("div",{className:"_2sb6"},m.createElement("div",{className:"_d9r"},this.props.expanding?this.props.detailedStatus:null),m.createElement("div",{className:"_d9s"},this.props.expanding?this.props.statusTime:null),y));},_getHref:function(){return k.getURIPathForIDOrVanity(this.props.id);},renderLayers:function(){if(!this.props.shouldShowNUX)return {};return {nux:(m.createElement(p,{alignment:"left",contextRef:function(){return this.refs.user;}.bind(this),customwidth:234,position:"left",onCloseButtonClick:this.props.onNUXSeen,shown:this.props.shouldShowNUX,width:"custom"},t._("Neu! Eine Chatleiste f\u00fcr kleinere Bildschirme. Klicke zum Chatten auf ein Foto oder fahre zum Einblenden mit der Maus dar\u00fcber.")))};},render:function(){return (m.createElement("li",{className:(("_2sb2")+(this.props.isOffline?' '+"_3maz":'')+(this.props.isHighlighted?' '+"_5aw":'')),onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver,ref:"user"},m.createElement(j,{className:"_2sb3",href:{url:this._getHref()},onClick:this._onClick,rel:"ignore"},m.createElement("div",{className:(("_2sb4")+(this.props.context?' '+"_1hmm":''))},m.createElement("div",m.__spread({},o.propsFor(this.props.expanding?'':this.props.name),{className:"_2sb5","data-tooltip-position":"left"}),this._renderImage()),this._renderName(),this._renderContext(),this._renderStatus()))));}});e.exports=w;},null);
__d("ChatMiniSidebarBody.react",["AsyncRequest","BanzaiODS","ChatConfig","ChatMiniSidebarUser.react","ChatMiniSidebarUserMixin","ChatSidebarSections","React","ScrollableArea.react","ShortProfiles","XUISpinner.react","XChatMiniSidebarNUXSeenController","cx","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';var t='chat_sidebar_visibility',u=m,v=u.PropTypes;h.setEntitySample(t,.0001);var w=m.createClass({displayName:"ChatMiniSidebarBody",mixins:[k],propTypes:{height:v.number.isRequired,expanding:v.bool,onMouseLeave:v.func,onMouseOver:v.func,onScroll:v.func,onOpenTab:v.func,users:v.array.isRequired},getDefaultProps:function(){return {expanding:false,onMouseLeave:s,onMouseOver:s,onScroll:s};},getInitialState:function(){return {loading:true,userData:[],showNUX:!i.get('seen_mini_sidebar_nux')};},componentDidMount:function(){this._populateUserData(this.props.users);this._logFriendCount();},componentWillReceiveProps:function(x){this._populateUserData(x.users);if(x.expanding!==this.props.expanding&&!i.get('seen_mini_sidebar_nux'))this._onNUXSeen();},_populateUserData:function(x){o.getMulti(x,function(y){var z=x.map(function(aa){return y[aa];});this.setState({loading:false,userData:z});}.bind(this));},_onNUXSeen:function(){this.setState({showNUX:false});i.set('seen_mini_sidebar_nux',true);var x=q.getURIBuilder().getURI();new g(x).send();},_renderUser:function(x,y){if(x.id=='0'||!x.is_friend)return null;var z=this.getStatus(x.id);return (m.createElement(j,{detailedStatus:z.detailedStatus,expanding:this.props.expanding,id:x.id,isOffline:z.offline,key:x.id,name:x.name,onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver,onNUXSeen:this._onNUXSeen,onOpenTab:this.props.onOpenTab,section:l.ORDERED_LIST,shouldShowNUX:y===0&&this.state.showNUX,status:z.status,statusTime:z.statusTime,thumbSrc:x.thumbSrc}));},render:function(){var x=null;if(this.state.loading){x=m.createElement("div",{className:"_1rg3"},m.createElement(p,null));}else x=m.createElement("ul",null,this.state.userData.map(function(y,z){return this._renderUser(y,z);}.bind(this)));return (m.createElement(n,{height:this.props.height,fade:true,onScroll:this.props.onScroll,persistent:true,shadow:false},x));},_logFriendCount:function(){this._logTimeout=setTimeout(function(){h.bumpEntityKey(t,this.props.users.length===0?'state_list_empty':'state_list_mounted');}.bind(this),5000);}});e.exports=w;},null);
__d("ChatMiniSidebarFooter.react",["ChatSidebarDropdown.react","ChatSidebarComposeLink.react","React","SearchableTextInput.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=i,o=n.PropTypes,p=i.createClass({displayName:"ChatMiniSidebarFooter",propTypes:{expanding:o.bool.isRequired,onClickSearch:o.func.isRequired,onEntriesFound:o.func.isRequired,onInputChanged:o.func.isRequired,onKeyDown:o.func.isRequired,onMenuHide:o.func,onMenuShow:o.func,onQueryFinished:o.func,onToggleSidebar:o.func.isRequired,source:o.object.isRequired},getDefaultProps:function(){return {onQueryFinished:l};},getInitialState:function(){return {query:''};},componentWillReceiveProps:function(q){if(q.expanding!==this.props.expanding)this.setState({query:''});},componentDidUpdate:function(q,r){if(!q.expanding&&this.props.expanding&&this.refs.searchInput){setTimeout(this.refs.searchInput.focusInput,0);this.props.source.refreshData();}},_onClickSearch:function(q){q.preventDefault();this.props.onClickSearch(true,this.state.query);},_onChange:function(q){var r=q.target.value;this.setState({query:r});this.props.onInputChanged(r);},_onMenuHide:function(){this.props.onMenuHide&&this.props.onMenuHide();},_onMenuShow:function(){this.props.onMenuShow&&this.props.onMenuShow();},_onQueryFinished:function(q){q===this.state.query&&this.props.onQueryFinished();},_renderSearchInput:function(){if(!this.props.expanding)return null;return (i.createElement("div",{className:"_3f-7"},i.createElement(j,{onChange:this._onChange,onEntriesFound:this.props.onEntriesFound,onKeyDown:this.props.onKeyDown,placeholder:m._("Suche"),queryString:this.state.query,ref:"searchInput",searchSource:this.props.source,searchSourceOptions:{onQueryFinished:this._onQueryFinished}})));},_renderComposeLink:function(){return (i.createElement(h,{className:"_3a-4 _3a-5"}));},_renderDropdown:function(){if(!this.props.expanding)return null;return (i.createElement(g,{className:"_43p4",isNormalSidebar:false,onHide:this._onMenuHide,onShow:this._onMenuShow,onToggleSidebar:this.props.onToggleSidebar}));},render:function(){return (i.createElement("div",{className:"_iup _1f7n",ref:"search"},i.createElement("div",{"aria-label":m._("Suchen"),className:"_35_4 _43p3","data-hover":"tooltip",onClick:this._onClickSearch,ref:"icon"}),this._renderSearchInput(),this._renderDropdown(),this._renderComposeLink()));}});e.exports=p;},null);
__d("ChatMiniSidebarSearchView.react",["ChatMiniSidebarThread.react","ChatMiniSidebarUser.react","ChatMiniSidebarUserMixin","ChatSidebarSections","ChatTypeaheadConstants","CurrentUser","immutable","MercuryIDs","PresenceStatus","ReactComponentWithPureRenderMixin","React","MessengerScrollableArea.react","MercuryThreadMetadataRawRenderer","XUISpinner.react","arrayContains","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();var x=q,y=x.PropTypes,z=k.FRIEND_TYPE,aa=k.THREAD_TYPE,ba=k.FB4C_TYPE,ca=k.PAGE_TYPE,da=k.NON_FRIEND_TYPE,ea=q.createClass({displayName:"ChatMiniSidebarSearchView",mixins:[i,p],propTypes:{entries:y.instanceOf(m.List).isRequired,height:y.number.isRequired,highlightID:y.string,onOpenTab:y.func,queryFinished:y.bool},componentDidMount:function(){this.refs.scrollable&&this.refs.scrollable.scrollToBottom();},componentWillUpdate:function(){var fa=this.refs.scrollable&&this.refs.scrollable.getArea();if(fa){this._wasScrolledToBottomBeforeUpdate=this.refs.scrollable.isScrolledToBottom();}else this._wasScrolledToBottomBeforeUpdate=true;},componentDidUpdate:function(fa){if(this._wasScrolledToBottomBeforeUpdate&&this.props.entries!==fa.entries)this.refs.scrollable&&this.refs.scrollable.scrollToBottom();},_checkThread:function(fa){var ga='fbid:'+l.getID();if(!u(fa.participants,ga))return false;return true;},_renderThread:function(fa,ga){var ha=fa.getUniqueID(),ia=fa.getAuxiliaryData();if(!ia)return null;var ja=ia.thread;if(!ja||!this._checkThread(ja))return null;var ka=ia.participantsToRender,la=ja.participants.length-1,ma=this._renderThreadName(ha,ka,la),na=o.getGroup(ja.participants.map(function(oa){return n.getUserIDFromParticipantID(oa);}));return (q.createElement(g,{context:ma,id:ha,isHighlighted:ha===this.props.highlightID,key:ha,threadName:ja.name,onOpenTab:this.props.onOpenTab,onScrollIntoView:this._handleScrollIntoView,participants:ia.participantsToRender,status:na,thumbSrc:fa.getPhoto()}));},_renderThreadName:function(fa,ga,ha){return s.renderRawParticipantList(fa,ga,ha,{names_renderer:s.renderShortNames});},_renderUser:function(fa,ga){var ha=fa.getUniqueID();if(ha=='0')return null;var ia=this.getStatus(ha),ja=fa.getType(),ka=ja===ba||ja===da||ja===ca?fa.getSubtitle():null;return (q.createElement(h,{context:ka,detailedStatus:ia.detailedStatus,expanding:true,id:ha,isHighlighted:ha===this.props.highlightID,isOffline:ia.offline,key:ha,name:fa.getTitle(),onOpenTab:this.props.onOpenTab,onScrollIntoView:this._handleScrollIntoView,section:j.TYPEAHEAD,status:ia.status,statusTime:ia.statusTime,thumbSrc:fa.getPhoto()}));},_renderHeader:function(fa){return (q.createElement("div",{key:fa,className:"_5tmy"},q.createElement("div",{className:"_5tn8"},fa)));},_renderSection:function(fa,ga){var ha=this.props.entries.filter(function(ja){return ja.getType()===fa;}).reverse(),ia=fa===aa?this._renderThread:this._renderUser;return ha.size>0?[this._renderHeader(ga)].concat(ha.map(ia).toArray()):[];},render:function(){var fa=null,ga="_9y8";if(this.props.entries.size===0){if(this.props.queryFinished){fa=w._("Keine Ergebnisse.");}else{fa=q.createElement(t,null);ga="_9y8 _1rg3";}}else fa=this._renderSection(da,w._("WEITERE PERSONEN")).concat(this._renderSection(ca,w._("SEITEN"))).concat(this._renderSection(aa,w._("GRUPPENUNTERHALTUNGEN"))).concat(this._renderSection(ba,w._("Arbeitskollegen"))).concat(this._renderSection(z,w._("FREUNDE")));return (q.createElement("div",{className:ga},q.createElement(r,{ref:"scrollable",style:{maxHeight:this.props.height}},q.createElement("div",{className:"_4bck"},fa))));},_handleScrollIntoView:function(fa){this.refs.scrollable&&this.refs.scrollable.getArea()&&this.refs.scrollable.getArea().scrollIntoView(fa);}});e.exports=ea;},null);
__d("ChatMiniSidebar.react",["AvailableList","AvailableListConstants","ChannelConnection","ChatOrderedList","ChatSidebarConstants","ChatSortUsers","ChatMiniSidebarBody.react","ChatMiniSidebarFooter.react","ChatMiniSidebarSearchView.react","ChatOpenTab","ChatSidebarSections","ChatTypeaheadConstants","Event","immutable","Keys","PresencePrivacy","ReactComponentWithPureRenderMixin","React","SubscriptionsHandler","createObjectFrom","cx","emptyFunction","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();'use strict';var da=x,ea=da.PropTypes,fa=6,ga=27,ha=x.createClass({displayName:"ChatMiniSidebar",mixins:[w],propTypes:{dataSource:ea.object.isRequired,height:ea.number.isRequired,maxEntries:ea.number,onClickSearch:ea.func.isRequired,onToggleSidebar:ea.func,shown:ea.bool},getDefaultProps:function(){return {maxEntries:0,onToggleSidebar:ba,shown:false};},getInitialState:function(){return {currentQueryFinished:false,canExpand:true,canShrink:true,expanding:false,highlightIndex:0,inside:false,isSearching:false,searchResults:new t.List(),users:[]};},componentWillMount:function(){this._subscriptions=new y();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,this._updateUsers),i.subscribe([i.CONNECTED,i.RECONNECTING,i.SHUTDOWN,i.MUTE_WARNING,i.UNMUTE_WARNING],ca(this.forceUpdate,this)),v.subscribe('privacy-user-presence-changed',this._updateUsers));this._updateUsers();},componentWillReceiveProps:function(ia){if(ia.shown!==this.props.shown)this.setState({currentQueryFinished:false,expanding:false,isSearching:false,searchResults:new t.List()});},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},_getScrollableAreaHeight:function(){return Math.max(this.props.height-fa-ga,0);},_updateUsers:function(){if(!this.props.shown)return;var ia=this._getScrollableAreaHeight(),ja=ia/k.getItemHeight(true),ka=j.getSortedList({},ja),la=j.getAvailableList(z(ka));la.sort(l.sortMobile);this.setState({users:ka.concat(la)});},_onClickSearch:function(ia,ja){this.props.onClickSearch(ia);this.setState({currentQueryFinished:false,expanding:ia,isSearching:!!ja,highlightIndex:0});},_onEntriesFound:function(ia){this.setState({highlightIndex:0,searchResults:new t.List(ia.slice(0,this.props.maxEntries))});},_onInputChanged:function(ia){var ja=!!ia;this.setState({currentQueryFinished:false,isSearching:ja});},_onMouseEnterSidebar:function(){this.setState({inside:true});clearTimeout(this._mouseLeaveCallback);clearTimeout(this._mouseOverCallback);},_onMenuHide:function(){!this.state.canShrink&&this.setState({canShrink:true});!this.state.inside&&this._onMouseLeaveSidebar();},_onMenuShow:function(){this.state.canShrink&&this.setState({canShrink:false});},_onMouseLeaveSidebar:function(){this.setState({inside:false});clearTimeout(this._mouseOverCallback);if(!this.state.expanding)return;clearTimeout(this._mouseLeaveCallback);this._mouseLeaveCallback=setTimeout(function(){(this.state.expanding&&this.state.canShrink)&&this._onClickSearch(false,'');}.bind(this),300);},_onMouseLeaveUser:function(){clearTimeout(this._mouseOverCallback);!this.state.canExpand&&this.setState({canExpand:true});},_onMouseOverUser:function(){clearTimeout(this._mouseLeaveCallback);if(this.state.expanding)return;clearTimeout(this._mouseOverCallback);this._mouseOverCallback=setTimeout(function(){(!this.state.expanding&&this.state.canExpand)&&this._onClickSearch(true,'');}.bind(this),500);},_onOpenTab:function(){this.setState({canExpand:false});this._onClickSearch(false,'');},_changeHighlight:function(ia){var ja=this.state.searchResults.size,ka=ja===0?0:(this.state.highlightIndex+ia)%ja;return ka>=0?ka:ja-1;},_onKeyDown:function(ia){var ja=s.getKeyCode(ia),ka=true;switch(ja){case u.UP:this.setState({highlightIndex:this._changeHighlight(1)});break;case u.DOWN:this.setState({highlightIndex:this._changeHighlight(-1)});break;case u.RETURN:var la=this.state.searchResults.get(this.state.highlightIndex);if(la){var ma=la.getUniqueID(),na=la.getType()===r.THREAD_TYPE?p.openThread:p.openUserTab;na(ma,q.TYPEAHEAD);this._onOpenTab();}break;default:ka=false;}ka&&ia.preventDefault();},_onQueryFinished:function(){this.setState({currentQueryFinished:true});},render:function(){if(!this.props.shown)return null;var ia=this._getScrollableAreaHeight(),ja=this.state.searchResults.get(this.state.highlightIndex),ka=ja?ja.getUniqueID():null,la=this.state.isSearching?x.createElement(o,{entries:this.state.searchResults,height:ia,highlightID:ka,onOpenTab:this._onOpenTab,queryFinished:this.state.currentQueryFinished}):x.createElement(m,{className:"_269x",height:ia,expanding:this.state.expanding,onMouseLeave:this._onMouseLeaveUser,onMouseOver:this._onMouseOverUser,onScroll:function(){return clearTimeout(this._mouseOverCallback);}.bind(this),onOpenTab:this._onOpenTab,users:this.state.users});return (x.createElement("div",{className:"_269v",onMouseEnter:this._onMouseEnterSidebar,onMouseLeave:this._onMouseLeaveSidebar,style:{height:this.props.height}},x.createElement("div",{className:"_269w"}),la,x.createElement(n,{expanding:this.state.expanding,onClickSearch:this._onClickSearch,onEntriesFound:this._onEntriesFound,onInputChanged:this._onInputChanged,onKeyDown:this._onKeyDown,onMenuHide:this._onMenuHide,onMenuShow:this._onMenuShow,onQueryFinished:this._onQueryFinished,onToggleSidebar:this.props.onToggleSidebar,source:this.props.dataSource})));}});e.exports=ha;},null);